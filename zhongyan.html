<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÊöóÂ§úÈÄÉÁîü - ÊÅêÊÄñÁîüÂ≠òÊ∏∏Êàè</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            color: #ccc;
            font-family: 'Microsoft YaHei', sans-serif;
            overflow: hidden;
            user-select: none;
            height: 100vh;
            perspective: 1000px;
        }
        
        #game-container {
            position: relative;
            width: 100%;
            height: 100%;
            background-color: #111;
            overflow: hidden;
        }
        
        #scene {
            position: absolute;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            transition: transform 0.3s, filter 0.5s;
            transform-style: preserve-3d;
        }
        
        #ui {
            position: absolute;
            bottom: 0;
            width: 100%;
            padding: 20px;
            box-sizing: border-box;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            text-align: center;
            z-index: 10;
        }
        
        #health-bar {
            width: 200px;
            height: 20px;
            background-color: #300;
            margin: 0 auto 10px;
            border: 1px solid #500;
            position: relative;
        }
        
        #health-fill {
            height: 100%;
            width: 100%;
            background-color: #a00;
            transition: width 0.3s;
        }
        
        #message {
            background-color: rgba(0, 0, 0, 0.7);
            padding: 15px;
            border-left: 3px solid #a00;
            margin: 10px 0;
            display: none;
        }
        
        #inventory {
            position: absolute;
            top: 20px;
            right: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border: 1px solid #333;
            border-radius: 5px;
            display: none;
        }
        
        .inventory-item {
            width: 50px;
            height: 50px;
            background-color: rgba(100, 0, 0, 0.3);
            margin: 5px;
            display: inline-block;
            border: 1px solid #500;
            text-align: center;
            line-height: 50px;
            cursor: pointer;
        }
        
        #actions {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .action-btn {
            background-color: rgba(50, 0, 0, 0.7);
            color: #ccc;
            border: 1px solid #a00;
            padding: 8px 15px;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .action-btn:hover {
            background-color: rgba(100, 0, 0, 0.7);
            color: #fff;
        }
        
        #menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 100;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
        
        #menu h1 {
            color: #a00;
            font-size: 3em;
            text-shadow: 0 0 10px #f00;
            margin-bottom: 30px;
        }
        
        .menu-btn {
            background-color: #300;
            color: #ccc;
            border: 1px solid #a00;
            padding: 15px 30px;
            margin: 10px;
            cursor: pointer;
            font-size: 1.2em;
            transition: all 0.3s;
            width: 200px;
            text-align: center;
        }
        
        .menu-btn:hover {
            background-color: #a00;
            color: #fff;
            text-shadow: 0 0 5px #fff;
        }
        
        #sound-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 1000;
            color: #ccc;
            cursor: pointer;
        }
        
        #jumpscare {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 10000;
            display: none;
        }
        
        #jumpscare-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .flicker {
            animation: flicker 0.3s infinite;
        }
        
        @keyframes flicker {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }
        
        #sanity-meter {
            position: absolute;
            top: 20px;
            left: 20px;
            width: 100px;
            height: 15px;
            background-color: #003;
            border: 1px solid #005;
        }
        
        #sanity-fill {
            height: 100%;
            width: 100%;
            background-color: #00a;
            transition: width 0.5s;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="scene"></div>
        
        <div id="ui">
            <div id="health-bar">
                <div id="health-fill"></div>
            </div>
            <div id="message"></div>
            <div id="actions"></div>
        </div>
        
        <div id="inventory">
            <h3>Áâ©ÂìÅÊ†è</h3>
            <div id="inventory-items"></div>
        </div>
        
        <div id="sanity-meter">
            <div id="sanity-fill"></div>
        </div>
        
        <div id="sound-toggle">üîä</div>
        
        <div id="jumpscare">
            <img id="jumpscare-img" src="" alt="">
        </div>
        
        <div id="menu">
            <h1>ÊöóÂ§úÈÄÉÁîü</h1>
            <div class="menu-btn" id="new-game">Êñ∞ÁöÑÊ∏∏Êàè</div>
            <div class="menu-btn" id="continue-game">ÁªßÁª≠Ê∏∏Êàè</div>
            <div class="menu-btn" id="settings">ËÆæÁΩÆ</div>
        </div>
    </div>
    
    <audio id="bgm" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-dark-ambient-1471.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="footsteps">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-footsteps-on-wood-floor-1357.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="door-creak">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-creaky-door-2296.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="whisper">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-scary-whispers-566.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="scream">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-woman-screams-in-horror-1524.mp3" type="audio/mpeg">
    </audio>
    
    <audio id="heartbeat">
        <source src="https://assets.mixkit.co/sfx/preview/mixkit-fast-heartbeat-1174.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        // Ê∏∏ÊàèÁä∂ÊÄÅ
        const gameState = {
            currentScene: 'entrance',
            health: 100,
            sanity: 100,
            inventory: [],
            hasFlashlight: false,
            hasKey: false,
            doorUnlocked: false,
            monsterActive: false,
            gameStarted: false,
            soundOn: true
        };
        
        // Âú∫ÊôØÊèèËø∞
        const scenes = {
            entrance: {
                image: 'https://images.unsplash.com/photo-1600585152220-90363fe7e115?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                description: '‰Ω†Á´ôÂú®‰∏ÄÂ∫ßÂ∫üÂºÉÁöÑËÄÅÂÆÖÂâç„ÄÇÊúàÂÖâÈÄèËøá‰πå‰∫ëÊó∂ÈöêÊó∂Áé∞ÔºåÁªôÁ†¥Ë¥•ÁöÑÂª∫Á≠ëËíô‰∏ä‰∏ÄÂ±ÇËØ°ÂºÇÁöÑÈì∂ÂÖâ„ÄÇÂâçÈó®ÂçäÂºÄÁùÄÔºåÂèëÂá∫‰ª§‰∫∫‰∏çÂÆâÁöÑÂê±ÂëÄÂ£∞„ÄÇ',
                actions: [
                    { text: 'ËøõÂÖ•ÂâçÈó®', nextScene: 'hallway', condition: () => true, sound: 'door-creak' },
                    { text: 'ÁªïÂà∞ÂêéÈô¢', nextScene: 'backyard', condition: () => true },
                    { text: 'Ê£ÄÊü•ÈÇÆÁÆ±', nextScene: 'mailbox', condition: () => true }
                ]
            },
            hallway: {
                image: 'https://images.unsplash.com/photo-1585771724684-38269d6639fd?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                description: 'Èò¥ÊöóÁöÑËµ∞ÂªäÂª∂‰º∏ÂêëÈªëÊöó‰∏≠„ÄÇÂ¢ôÁ∫∏Ââ•ËêΩÔºåÂú∞ÊùøÂú®‰Ω†ËÑö‰∏ãÂê±Âê±‰ΩúÂìç„ÄÇÂ∑¶ËæπÊòØ‰∏ÄÊâáÂÖ≥ÁùÄÁöÑÈó®ÔºåÂè≥ËæπÊ•ºÊ¢ØÈÄöÂêë‰∫åÊ•º„ÄÇËµ∞ÂªäÂ∞ΩÂ§¥Êúâ‰∏ÄÈù¢Á†¥Á¢éÁöÑÈïúÂ≠ê„ÄÇ',
                actions: [
                    { text: '‰∏äÊ•º', nextScene: 'stairs', condition: () => true, sound: 'footsteps' },
                    { text: 'Ê£ÄÊü•Â∑¶ËæπÁöÑÈó®', nextScene: 'living-room', condition: () => true, sound: 'door-creak' },
                    { text: 'Êü•ÁúãÈïúÂ≠ê', nextScene: 'mirror', condition: () => true },
                    { text: 'ËøîÂõûÂÖ•Âè£', nextScene: 'entrance', condition: () => true }
                ],
                onEnter: () => {
                    if(Math.random() > 0.7 && !gameState.monsterActive) {
                        showMessage("‰Ω†Âê¨Âà∞Ë∫´ÂêéÊúâÊ≤ôÊ≤ôÂ£∞...", 3000);
                        playSound('whisper');
                        setTimeout(() => {
                            if(gameState.currentScene === 'hallway') {
                                triggerJumpscare();
                            }
                        }, 2000);
                    }
                }
            },
            living_room: {
                image: 'https://images.unsplash.com/photo-1600607688969-a5bfcd646154?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                description: 'ÂÆ¢ÂéÖÈáåÂÆ∂ÂÖ∑ÈÉΩÁõñÁùÄÁôΩÂ∏ÉÔºåÂÉè‰∏ÄÊéíÊéíÂπΩÁÅµ„ÄÇÂ£ÅÁÇâÈáåËøòÊúâÊú™ÁáÉÂ∞ΩÁöÑÊú®ÁÇ≠„ÄÇÁîµËßÜÊú∫Â±èÂπïÁ†¥Á¢éÔºåÂèçÂ∞ÑÁùÄËØ°ÂºÇÁöÑÂÖâ„ÄÇ',
                actions: [
                    { text: 'Ê£ÄÊü•Â£ÅÁÇâ', nextScene: 'fireplace', condition: () => true },
                    { text: 'ÊéÄÂºÄÊ≤ôÂèë‰∏äÁöÑÁôΩÂ∏É', nextScene: 'sofa', condition: () => true },
                    { text: 'ËøîÂõûËµ∞Âªä', nextScene: 'hallway', condition: () => true, sound: 'door-creak' }
                ],
                onEnter: () => {
                    if(!gameState.hasFlashlight && Math.random() > 0.5) {
                        gameState.hasFlashlight = true;
                        gameState.inventory.push('flashlight');
                        showMessage("‰Ω†Âú®Ê≤ôÂèë‰∏ãÊâæÂà∞‰∫Ü‰∏ÄÊîØÊâãÁîµÁ≠íÔºÅ", 3000);
                        updateInventory();
                    }
                }
            },
            bedroom: {
                image: 'https://images.unsplash.com/photo-1584622650111-993a426fbf0a?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                description: 'ÂçßÂÆ§ÈáåÊúâ‰∏ÄÂº†ÂõõÊü±Â∫äÔºåÂ∏∑ÂπîÁ†¥Êóß„ÄÇÊ¢≥Â¶ÜÂè∞‰∏äÊëÜÊª°‰∫ÜÂèëÈúâÁöÑÂåñÂ¶ÜÂìÅ„ÄÇË°£ÊüúÈó®ÂæÆÂæÆÊôÉÂä®ÔºåÂ•ΩÂÉèÂàöÂàöÊúâ‰∫∫ÂÖ≥‰∏ä‰∫ÜÂÆÉ„ÄÇ',
                actions: [
                    { text: 'Ê£ÄÊü•Ë°£Êüú', nextScene: 'wardrobe', condition: () => true },
                    { text: 'Êü•ÁúãÂ∫ä‰∏ã', nextScene: 'under-bed', condition: () => true },
                    { text: 'ËøîÂõûËµ∞Âªä', nextScene: 'hallway', condition: () => true }
                ],
                onEnter: () => {
                    if(Math.random() > 0.8) {
                        document.getElementById('scene').classList.add('flicker');
                        showMessage("ÁÅØÂÖâÈó™ÁÉÅ...Êúâ‰ªÄ‰πà‰∏úË•øÂú®Èù†Ëøë...", 2000);
                        setTimeout(() => {
                            document.getElementById('scene').classList.remove('flicker');
                        }, 2000);
                    }
                }
            },
            basement: {
                image: 'https://images.unsplash.com/photo-1600607687920-4e2a09cf159d?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80',
                description: 'ÊΩÆÊπøÁöÑÂú∞‰∏ãÂÆ§Êï£ÂèëÁùÄÈúâÂë≥„ÄÇÂ¢ô‰∏äÊåÇÁùÄÁîüÈîàÁöÑÂ∑•ÂÖ∑„ÄÇËßíËêΩÈáåÊúâ‰∏Ä‰∏™ÈîÅÁùÄÁöÑÁÆ±Â≠ê„ÄÇÊ•ºÊ¢Ø‰∏äÊñπ‰º†Êù•Â•áÊÄ™ÁöÑÂàÆÊì¶Â£∞„ÄÇ',
                actions: [
                    { text: 'Ê£ÄÊü•ÁÆ±Â≠ê', nextScene: 'chest', condition: () => true },
                    { text: '‰∏äÊ•º', nextScene: 'hallway', condition: () => true, sound: 'footsteps' },
                    { text: 'Êü•ÁúãÂ∑•ÂÖ∑', nextScene: 'tools', condition: () => true }
                ],
                onEnter: () => {
                    decreaseSanity(10);
                    if(!gameState.hasKey && Math.random() > 0.6) {
                        gameState.hasKey = true;
                        gameState.inventory.push('key');
                        showMessage("‰Ω†Âú®Â∑•ÂÖ∑Â†ÜÈáåÂèëÁé∞‰∫Ü‰∏ÄÊääÈí•ÂåôÔºÅ", 3000);
                        updateInventory();
                    }
                }
            }
        };
        
        // ÂàùÂßãÂåñÊ∏∏Êàè
        function initGame() {
            document.getElementById('new-game').addEventListener('click', startNewGame);
            document.getElementById('continue-game').addEventListener('click', continueGame);
            document.getElementById('sound-toggle').addEventListener('click', toggleSound);
            
            // Âä†ËΩΩ‰øùÂ≠òÁöÑÊ∏∏Êàè
            const savedGame = localStorage.getItem('horrorEscapeGame');
            if(savedGame) {
                document.getElementById('continue-game').style.display = 'block';
            } else {
                document.getElementById('continue-game').style.display = 'none';
            }
            
            // ÂºÄÂßãËÉåÊôØÈü≥‰πê
            playSound('bgm', 0.3);
        }
        
        // ÂºÄÂßãÊñ∞Ê∏∏Êàè
        function startNewGame() {
            // ÈáçÁΩÆÊ∏∏ÊàèÁä∂ÊÄÅ
            gameState.currentScene = 'entrance';
            gameState.health = 100;
            gameState.sanity = 100;
            gameState.inventory = [];
            gameState.hasFlashlight = false;
            gameState.hasKey = false;
            gameState.doorUnlocked = false;
            gameState.monsterActive = false;
            gameState.gameStarted = true;
            
            updateHealth();
            updateSanity();
            updateInventory();
            
            document.getElementById('menu').style.display = 'none';
            loadScene(gameState.currentScene);
        }
        
        // ÁªßÁª≠Ê∏∏Êàè
        function continueGame() {
            const savedGame = JSON.parse(localStorage.getItem('horrorEscapeGame'));
            Object.assign(gameState, savedGame);
            gameState.gameStarted = true;
            
            updateHealth();
            updateSanity();
            updateInventory();
            
            document.getElementById('menu').style.display = 'none';
            loadScene(gameState.currentScene);
        }
        
        // ‰øùÂ≠òÊ∏∏Êàè
        function saveGame() {
            localStorage.setItem('horrorEscapeGame', JSON.stringify(gameState));
        }
        
        // Âä†ËΩΩÂú∫ÊôØ
        function loadScene(sceneId) {
            const scene = scenes[sceneId];
            if(!scene) return;
            
            gameState.currentScene = sceneId;
            document.getElementById('scene').style.backgroundImage = `url('${scene.image}')`;
            
            // ÊòæÁ§∫Âú∫ÊôØÊèèËø∞
            showMessage(scene.description, 5000);
            
            // Ê∏ÖÈô§ÊóßÂä®‰Ωú
            const actionsContainer = document.getElementById('actions');
            actionsContainer.innerHTML = '';
            
            // Ê∑ªÂä†Êñ∞Âä®‰Ωú
            scene.actions.forEach(action => {
                if(!action.condition || action.condition()) {
                    const btn = document.createElement('div');
                    btn.className = 'action-btn';
                    btn.textContent = action.text;
                    btn.addEventListener('click', () => {
                        if(action.sound) {
                            playSound(action.sound);
                        }
                        loadScene(action.nextScene);
                    });
                    actionsContainer.appendChild(btn);
                }
            });
            
            // Ê∑ªÂä†Áâ©ÂìÅÊ†èÊåâÈíÆ
            const inventoryBtn = document.createElement('div');
            inventoryBtn.className = 'action-btn';
            inventoryBtn.textContent = 'Áâ©ÂìÅÊ†è';
            inventoryBtn.addEventListener('click', toggleInventory);
            actionsContainer.appendChild(inventoryBtn);
            
            // Ë∞ÉÁî®Âú∫ÊôØËøõÂÖ•‰∫ã‰ª∂
            if(scene.onEnter) {
                scene.onEnter();
            }
            
            // ÈöèÊú∫ÊÅêÊÄñ‰∫ã‰ª∂
            if(Math.random() > 0.8 && sceneId !== 'entrance') {
                randomHorrorEvent();
            }
            
            // Ëá™Âä®‰øùÂ≠ò
            saveGame();
        }
        
        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(text, duration = 3000) {
            const msgElement = document.getElementById('message');
            msgElement.textContent = text;
            msgElement.style.display = 'block';
            
            if(duration > 0) {
                setTimeout(() => {
                    msgElement.style.display = 'none';
                }, duration);
            }
        }
        
        // Êõ¥Êñ∞ÁîüÂëΩÂÄºÊòæÁ§∫
        function updateHealth() {
            document.getElementById('health-fill').style.width = `${gameState.health}%`;
        }
        
        // Êõ¥Êñ∞ÁêÜÊô∫ÂÄºÊòæÁ§∫
        function updateSanity() {
            document.getElementById('sanity-fill').style.width = `${gameState.sanity}%`;
            
            // ÁêÜÊô∫ÂÄº‰ΩéÁöÑÊïàÊûú
            if(gameState.sanity < 30) {
                document.body.style.filter = 'hue-rotate(90deg)';
                if(Math.random() > 0.9) {
                    showMessage("‰Ω†ÂºÄÂßã‰∫ßÁîüÂπªËßâ...Êúâ‰ªÄ‰πà‰∏úË•øÂú®ÁúãÁùÄ‰Ω†...", 2000);
                }
            } else {
                document.body.style.filter = 'none';
            }
        }
        
        // ÂáèÂ∞ëÁêÜÊô∫ÂÄº
        function decreaseSanity(amount) {
            gameState.sanity = Math.max(0, gameState.sanity - amount);
            updateSanity();
            
            if(gameState.sanity <= 0) {
                gameOver("‰Ω†ÁöÑÁêÜÊô∫Â¥©Ê∫É‰∫ÜÔºåÈô∑ÂÖ•‰∫ÜÁñØÁãÇ...");
            }
        }
        
        // Êõ¥Êñ∞Áâ©ÂìÅÊ†è
        function updateInventory() {
            const inventoryItems = document.getElementById('inventory-items');
            inventoryItems.innerHTML = '';
            
            gameState.inventory.forEach(item => {
                const itemElement = document.createElement('div');
                itemElement.className = 'inventory-item';
                itemElement.textContent = item === 'flashlight' ? 'üî¶' : item === 'key' ? 'üîë' : '?';
                itemElement.addEventListener('click', () => useItem(item));
                inventoryItems.appendChild(itemElement);
            });
        }
        
        // ‰ΩøÁî®Áâ©ÂìÅ
        function useItem(item) {
            if(item === 'flashlight') {
                showMessage("‰Ω†ÊâìÂºÄ‰∫ÜÊâãÁîµÁ≠íÔºåÂë®Âõ¥‰∫Æ‰∫ÜËµ∑Êù•„ÄÇ", 2000);
                document.getElementById('scene').style.filter = 'brightness(1.5)';
                setTimeout(() => {
                    document.getElementById('scene').style.filter = 'brightness(1)';
                }, 2000);
            } else if(item === 'key' && gameState.currentScene === 'chest') {
                showMessage("‰Ω†Áî®Èí•ÂåôÊâìÂºÄ‰∫ÜÁÆ±Â≠êÔºÅÈáåÈù¢Êúâ‰∏ÄÂº†Á∫∏Êù°Ôºö'Âø´ÈÄÉ...ÂÆÉÊù•‰∫Ü...'", 4000);
                gameState.doorUnlocked = true;
            }
        }
        
        // ÂàáÊç¢Áâ©ÂìÅÊ†èÊòæÁ§∫
        function toggleInventory() {
            const inventory = document.getElementById('inventory');
            inventory.style.display = inventory.style.display === 'block' ? 'none' : 'block';
        }
        
        // ÈöèÊú∫ÊÅêÊÄñ‰∫ã‰ª∂
        function randomHorrorEvent() {
            const events = [
                () => {
                    showMessage("‰Ω†Âê¨Âà∞ËøúÂ§Ñ‰º†Êù•‰ΩéËØ≠Â£∞...", 2000);
                    playSound('whisper');
                    decreaseSanity(5);
                },
                () => {
                    showMessage("Â¢ô‰∏äÁöÑÈò¥ÂΩ±‰ºº‰πéÂú®ÁßªÂä®...", 2000);
                    decreaseSanity(8);
                },
                () => {
                    if(!gameState.monsterActive) {
                        showMessage("Êúâ‰ªÄ‰πà‰∏úË•øÂú®Ë∑üÁùÄ‰Ω†...", 2000);
                        playSound('footsteps');
                        setTimeout(() => {
                            if(Math.random() > 0.5) {
                                triggerJumpscare();
                            }
                        }, 3000);
                    }
                }
            ];
            
            const randomEvent = events[Math.floor(Math.random() * events.length)];
            randomEvent();
        }
        
        // Ëß¶ÂèëË∑≥Âêì
        function triggerJumpscare() {
            gameState.monsterActive = true;
            playSound('scream');
            
            const jumpscare = document.getElementById('jumpscare');
            const jumpscareImg = document.getElementById('jumpscare-img');
            
            // ÈöèÊú∫ÈÄâÊã©Ë∑≥ÂêìÂõæÁâá
            const jumpscares = [
                'https://i.imgur.com/XdQaZQj.jpg',
                'https://i.imgur.com/Yq9WQvJ.jpg',
                'https://i.imgur.com/Zq9WQvJ.jpg'
            ];
            
            jumpscareImg.src = jumpscares[Math.floor(Math.random() * jumpscares.length)];
            jumpscare.style.display = 'block';
            
            setTimeout(() => {
                jumpscare.style.display = 'none';
                gameState.health -= 20;
                gameState.sanity -= 30;
                updateHealth();
                updateSanity();
                
                if(gameState.health <= 0) {
                    gameOver("‰Ω†Ë¢´ÊÅêÊÄñÁöÑÁîüÁâ©ÊùÄÊ≠ª‰∫Ü...");
                } else {
                    showMessage("‰Ω†ÂãâÂº∫ÈÄÉËÑ±‰∫ÜÔºå‰ΩÜÂèó‰∫Ü‰º§...", 3000);
                    gameState.monsterActive = false;
                }
            }, 1000);
        }
        
        // Ê∏∏ÊàèÁªìÊùü
        function gameOver(message) {
            showMessage(message, 0);
            playSound('heartbeat');
            
            const actionsContainer = document.getElementById('actions');
            actionsContainer.innerHTML = '';
            
            const restartBtn = document.createElement('div');
            restartBtn.className = 'action-btn';
            restartBtn.textContent = 'ÈáçÊñ∞ÂºÄÂßã';
            restartBtn.addEventListener('click', () => {
                document.location.reload();
            });
            actionsContainer.appendChild(restartBtn);
        }
        
        // Êí≠ÊîæÈü≥Êïà
        function playSound(soundId, volume = 1.0) {
            if(!gameState.soundOn) return;
            
            const sound = document.getElementById(soundId);
            sound.volume = volume;
            sound.currentTime = 0;
            sound.play().catch(e => console.log("Êó†Ê≥ïÊí≠ÊîæÂ£∞Èü≥:", e));
        }
        
        // ÂàáÊç¢Â£∞Èü≥
        function toggleSound() {
            gameState.soundOn = !gameState.soundOn;
            document.getElementById('sound-toggle').textContent = gameState.soundOn ? 'üîä' : 'üîá';
            
            if(gameState.soundOn) {
                playSound('bgm', 0.3);
            } else {
                document.getElementById('bgm').pause();
            }
        }
        
        // ÂêØÂä®Ê∏∏Êàè
        window.onload = initGame;
    </script>
</body>
</html>